#!/usr/bin/env bash

# TODO: --quiet
# TODO: pass nickel flags
#
DIRNAME=$(dirname "$0")
export NICKEL_IMPORT_PATH="${DIRNAME}:${NICKEL_IMPORT_PATH:-}"

# TOOD: mac does not have realpath :(
FILENAME=$(realpath "$1")

cat <<EOF | nickel export -f yaml
let spec = import "$FILENAME" in
let schema = import "schemas/main.ncl" in
spec | schema
EOF

